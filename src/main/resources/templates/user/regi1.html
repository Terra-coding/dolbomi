<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="/asset/css/regi.css">
    <link rel="stylesheet" href="/asset/css/header.css">
    <link rel="stylesheet" href="/asset/css/footer.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap"
          rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <style>
        /*서비스 신청 목록 네비게이션*/
        .menu03{
            display: none!important;
        }
    </style>
</head>

<body data-aos-easing="ease" data-aos-duration="400" data-aos-delay="0">
<header th:replace="header.html"></header>
<div id="root">
    <div id="app-container" class="app-container">

        <div class="main-area">
            <div class="sc-dRCTWM bvYJlY">
                <div class="sc-hzNEM iKMJbd">
                    <div class="register-container">
                        <div class="inner-container">
                            <div class="register-form">
                                <div class="title-wrapper">
                                    <span>1/2</span>
                                    <p>회원가입</p>
                                </div>
                                <div class="form">
                                    <form method="post" action="/user/regi1" id="joinForm1" name="joinForm1">
                                        <div class="form snd"><label>이름</label><input name="userName" type="text" placeholder="ex. 홍길동"
                                                                                      class="ant-input sc-jzJRlG iaafvp"
                                                                                      value="">
                                            <div class="sc-VigVT dUXpIL"></div>
                                            <label>성별</label>
                                            <div class="type-button-wrapper">
                                                <div id="M" class="type-button div2 clicked" name="userGender" >남자</div>
                                                <div id="W" class="type-button div2" name="userGender" >여자</div>
                                                <input type="hidden" name="userGender">
                                            </div>
                                            <div class="sc-VigVT dUXpIL"></div>
                                            <label>생년월일</label><input name="userBirth" type="text"
                                                                      maxlength="8" placeholder="숫자만 입력해주세요 (ex. 19880320)"
                                                                      class="ant-input sc-jzJRlG iaafvp" value="">
                                            <div class="form fst"><label>이메일</label>
                                                <div><input name="userEmail" type="email" id="emailCheck" required="" placeholder="ex) example@mail.com"
                                                            class="ant-input sc-jzJRlG iaafvp" oninput="check_email()" value=""
                                                            style="width: 100%">
                                                </div>
                                            </div>
                                            <!--email 중복체크-->
                                            <span class="email_ok">사용 가능한 이메일입니다.</span>
                                            <span class="email_already">이미 가입한 이메일입니다.</span>
                                            <span class="email_not">올바른 이메일 형식이 아닙니다.</span>
                                            <div class="sc-VigVT ffyjKW"></div>
                                            <div class="sc-cooIXK fRCQoH">
                                                <input type="checkbox" id="join_check" name="join_check"> <label>&nbsp;&nbsp; 서비스 이용 약관 및 개인 정보 처리 방침 동의</label>
                                            </div>
                                            <p class="sc-gmeYpB bwhqaA">이용약관 확인하기</p>
                                            <p class="sc-gmeYpB bwhqaA">개인정보 처리방침 확인하기</p>
                                            <div class="sc-VigVT dUXpIL"></div>
                                            <button type="button"
                                                    class="ant-btn ant-btn-primary"
                                                    style="background-color: #3bc1ff; border: 0px; cursor: pointer;" onclick="regi1Confirm()">
                                                <span>계속하기</span></button>
                                            <div class="link-wrapper"><span class="text">매니저 신청을 희망하시나요? </span><span
                                                    class="link" onclick="location.href='/member/managerapply'">매니저 신청하기</span>
                                            </div>
                                            <div class="link-wrapper"><span class="text">이미 계정이 있으신가요? </span><span
                                                    class="link" onclick="location.href='/member/userlogin'">로그인</span></div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>
</div>
<footer th:replace="footer.html"></footer>
</body>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    let $userGender = $("input[name='userGender']")
    /*유효성 검사 */
    function regi1Confirm(){
        var $userName = $("input[name='userName']");
        var $userBirth = $("input[name='userBirth']");
        var $userEmail = $("input[name='userEmail']");
        var $joinForm1 = $(joinForm1);

        if(!$userName.val()){
            alert("이름을 입력해 주세요");
            $userName.focus();
            console.log("들어옴")
            return false;
        }

        if(!$userBirth.val()){
            alert("생년월일을 입력해 주세요");
            $userBirth.focus();
            return false;
        }

        if(!$userEmail.val()){
            alert("이메일을 입력해 주세요");
            $userEmail.focus();
            return false;
        }

        if (!join_check.checked) {
            alert("서비스 이용약관 및 개인 정보 처리 방침에 동의해 주세요");
            join_check.focus();
            return false;
        }
        $joinForm1.submit();

    }

    $("#btnLogin").click(function () {
        if (!$(this).attr('class').match('on')) {
            $(this).addClass('on');
            $(".fnc_user_wrap").addClass('on');
        } else {
            $(this).removeClass('on');
            $(".fnc_user_wrap").removeClass('on');
        }
    })

    /* 성별 버튼 클릭 */
    var div2 = document.getElementsByClassName("div2");

    function handleClick(event) {
        console.log(event.target);
        // console.log(this);
        // 콘솔창을 보면 둘다 동일한 값이 나온다

        console.log(event.target.classList);

        if (event.target.classList[1] === "clicked") {
            event.target.classList.remove("clicked");
        } else {
            for (var i = 0; i < div2.length; i++) {
                div2[i].classList.remove("clicked");
            }

            event.target.classList.add("clicked");
            $userGender.val(event.target.id);
        }
    }

    function init() {
        for (var i = 0; i < div2.length; i++) {
            div2[i].addEventListener("click", handleClick);
        }
    }

    init();

    /*/!*이메일 정규식*!/
    var emailRule = /^[0-9a-zA-Z]([-_.]?[0-9a-zA-Z])*@[0-9a-zA-Z]([-_.]?[0-9a-zA-Z])*.[a-zA-Z]{2,3}$/i;//이메일 정규식

    if(!emailRule.test($("input[id='emailCheck']").val())) {
        //경고
    }
*/

    /*이메일 중복검사*/
    function check_email() {
        var email = $('#emailCheck').val();
        var emailRule = /^[0-9a-zA-Z]([-_\.]?[0-9a-zA-Z])*@[0-9a-zA-Z]([-_\.]?[0-9a-zA-Z])*\.[a-zA-Z]{2,3}$/i;//이메일 정규식

        $.ajax({
            url:'/user/emailcheck/',
            type:'post',
            data:{userEmail:email},
            success:function (cnt) {
                if(cnt == 0){
                    if(!emailRule.test(email)) {
                        //경고
                        $('.email_not').css("display", "inline-block");
                        $('.email_ok').css("display", "none");
                        $('.email_already').css("display", "none");
                    }else{
                        $('.email_not').css("display", "none");
                        $('.email_ok').css("display", "inline-block");
                        $('.email_already').css("display", "none");
                    }

                }else{
                    $('.email_already').css("display", "inline-block");
                    $('.email_ok').css("display","none");
                    $('.email_not').css("display", "none");
                }
            },
            error:function () {
            }
        });
    };



</script>
</html>